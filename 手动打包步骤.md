# 阿里巴巴供应商爬虫 - 手动打包步骤

## 方法一：使用PyInstaller（推荐）

### 步骤1：安装PyInstaller
```bash
# 以管理员身份运行命令提示符，然后执行：
pip install pyinstaller
```

### 步骤2：执行打包命令
```bash
pyinstaller --onefile --windowed --name "阿里巴巴供应商爬虫" --add-data "cary.json;." --add-data "alibaba_supplier_crawler.py;." --hidden-import aiohttp --hidden-import asyncio --hidden-import sqlite3 --hidden-import tkinter --hidden-import requests --hidden-import urllib.parse --hidden-import json --hidden-import time --hidden-import random --hidden-import threading --hidden-import platform --hidden-import subprocess --hidden-import os --hidden-import re alibaba_crawler_gui.py
```

### 步骤3：复制必要文件
```bash
# 将cary.json复制到dist目录
copy cary.json dist\
```

## 方法二：使用auto-py-to-exe（图形界面）

### 步骤1：安装auto-py-to-exe
```bash
pip install auto-py-to-exe
```

### 步骤2：启动图形界面
```bash
python -m auto_py_to_exe
```

### 步骤3：配置设置
1. **Script Location**: 选择 `alibaba_crawler_gui.py`
2. **Onefile**: 选择 "One File"
3. **Console Window**: 选择 "Window Based"
4. **Additional Files**: 添加 `cary.json` 和 `alibaba_supplier_crawler.py`
5. **Output Directory**: 选择输出目录
6. **Convert**: 点击开始打包

## 方法三：使用Nuitka（更小的文件）

### 步骤1：安装Nuitka
```bash
pip install nuitka
```

### 步骤2：执行打包
```bash
python -m nuitka --onefile --windows-disable-console --include-data-files=cary.json=cary.json --include-data-files=alibaba_supplier_crawler.py=alibaba_supplier_crawler.py alibaba_crawler_gui.py
```

## 打包后的文件结构

```
dist/
├── 阿里巴巴供应商爬虫.exe    # 主程序
├── cary.json              # 分类数据文件
└── alibaba_supplier_data.db  # 数据库文件（运行时创建）
```

## 运行要求

### 系统要求
- Windows 7/8/10/11
- 至少 100MB 可用磁盘空间
- 网络连接（用于爬取数据）

### 依赖文件
- `cary.json`: 分类数据文件（必须）
- 数据库文件会在首次运行时自动创建

## 使用说明

### 1. 启动程序
双击 `阿里巴巴供应商爬虫.exe` 启动程序

### 2. 功能说明
- **获取供应商**: 爬取阿里巴巴供应商数据
- **一键获取执照**: 批量提取供应商执照信息
- **代理配置**: 配置网络代理设置

### 3. 数据保存
- 供应商数据保存在 `alibaba_supplier_data.db`
- 执照图片保存在 `license_files/` 目录
- 按分类自动创建子目录

## 常见问题解决

### Q: 打包失败怎么办？
A: 尝试以下解决方案：
1. **以管理员身份运行命令提示符**
2. **更新pip**: `python -m pip install --upgrade pip`
3. **清理缓存**: `pip cache purge`
4. **使用虚拟环境**:
   ```bash
   python -m venv venv
   venv\Scripts\activate
   pip install pyinstaller
   ```

### Q: 程序运行时报错？
A: 检查以下项目：
1. 确保 `cary.json` 文件存在
2. 检查网络连接
3. 确认代理配置正确
4. 查看程序日志

### Q: 文件太大怎么办？
A: 可以尝试：
1. 使用 `--onedir` 而不是 `--onefile`
2. 排除不必要的模块
3. 使用UPX压缩（需要额外安装）

## 优化建议

### 1. 减小文件大小
```bash
# 使用UPX压缩（需要先安装UPX）
pyinstaller --onefile --windowed --upx-dir=upx --name "阿里巴巴供应商爬虫" alibaba_crawler_gui.py
```

### 2. 提高启动速度
```bash
# 使用--onedir模式
pyinstaller --onedir --windowed --name "阿里巴巴供应商爬虫" alibaba_crawler_gui.py
```

### 3. 添加图标
```bash
# 准备一个.ico文件，然后使用--icon参数
pyinstaller --onefile --windowed --icon=icon.ico --name "阿里巴巴供应商爬虫" alibaba_crawler_gui.py
```

## 技术细节

### 主要依赖
- tkinter: GUI界面
- aiohttp: 异步HTTP请求
- asyncio: 异步编程
- sqlite3: 数据库操作
- requests: HTTP请求
- urllib.parse: URL处理

### 打包优化
- 使用 `--hidden-import` 确保所有模块被包含
- 使用 `--exclude-module` 排除不需要的模块
- 使用 `--add-data` 包含必要的数据文件

## 更新日志

### v1.0
- 初始版本
- 支持供应商爬取
- 支持执照提取
- 支持代理配置
- 支持分类搜索 